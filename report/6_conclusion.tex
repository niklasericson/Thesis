% !TEX root = main.tex
\chapter{Conclusion and Future work}\label{cha:conclusion}
This thesis has investigated in different control approaches aiming to improve the tracking capability of the rotational stage used in the UA9 collimation studies at \abbrCERN. The investigation has showed the \abbrIRC method can be used to efficiently attenuate the first resonance peak and increase the closed loop bandwidth. It also showed that the \abbrMRACPE can be used to adapt to model changes and prevent instability. Furthermore it has shown that harmonic cancellation can be used to efficiently damp out known harmonic oscillations. Finally a feedforward harmonic cancellation method (\abbrRFDC) was implemented and proposed as an add-on control algorithm. This algorithm was first introduced for the control of hard disks but has in this thesis shown to be effective with resonant, piezo-actuated stages as well.

\section{Conclusions}
The results gathered during the simulations and the implementation of the \abbrRFDC are discussed below. The findings made in this thesis are presented with respect to the results presented in Chapter~\ref{cha:result} and \ref{cha:exp_result}, highlighting theoretical and practical considerations.

\subsection{Simulations}
\subsubsection{Stand-alone control approaches}
The comparison presented in Section~\ref{sec:comparison} summarizes the simulation results. Looking at Table~\ref{tab:comp}, none of the control approaches are superior to another but the \abbrIRC is the most promising one with respect to the trade-off between tracking accuracy, sensitivity to model errors, stability issues and implementation considerations. The \abbrIRC handles severe model errors corresponding to a first resonance peak being moved from its original position in 38.1Hz to 22Hz and 67.2Hz, respectively. The model changes are by far more significant than the results presented in Figure~\ref{fig:different_angles}, depicting the model's yaw angular dependence, meaning that the \abbrIRC would be robust to these variations. Worth mentioning is also that the present controller has shown to be robust to the identified and more realistic model changes (the table only shows the resonance values where one approach becomes unstable).

In this context and for low angular rates, the adaptive controller has shown good results. However, the adaptive controller has shown drawbacks in many other aspects such as stability and disturbance rejection as outlined in the table. Instability can be caused if the controller has a too high gain with respect to the step size that is applied as input. This nonlinear phenomenon was observed in simulations without any saturation of the input signal, indicating that the amplitude dependent behavior shown in Figure~\ref{fig:step_adaptive} might be due to numerical errors. A higher sampling rate would, if not solve the problem completely, at least enhance the border to instability. Another way to maintain stability is to select the initial values more wisely to obtain a quicker convergence without increasing the gain. Figure~\ref{fig:periodic_resp} shows the adaptive performance of a periodic input, showing that the controller performs much better for the second period when the parameter is closer to their final value. Considering these issues, the adaptive controller might be better for being used as a secondary controller for long term parameter adaption, at least for operation in 2kHz.

The major advantage with the \abbrIRC is that it attenuates the first resonance peak, allowing for a higher bandwidth but also that this attenuation follows, at least in some extent, the changes in the resonance peak. The negative feedforward gain impacts on the placement of the interlacing zeros, but the placement is also highly dependent on the system itself, since it is in closed loop with the gain. With its higher bandwidth the \abbrIRC outperformed the present controller in tracking accuracy as shown in Aspect 3 in Table~\ref{tab:comp}. However, neither the present nor the \abbrIRC eliminates the constant ramp tracking error completely due to a non-existing double integrator in the controller. A high bandwidth also implies in a controller that is more sensitive to measurement noise and to model errors in terms of stability, as shown in Figure~\ref{fig:model_dist_high_order}. Considering the fact that the yaw angle measurement is done by interfering with light in ultra high vacuum, there is no significant measurement error to be taken into account.

\subsubsection{Harmonic cancellation}
To increase the tracking accuracy even further, the \abbrIRC could be used in combination with a harmonics cancellation algorithm. The simulations in this thesis has shown that the \abbrRFDC could be a good candidate for canceling specific harmonic disturbances, especially the ones induced outside the closed loop bandwidth, not reachable by the controller itself. In Table~\ref{tab:comp_h} the \abbrIMP might seem superior at a first glance but this is not the case. The \abbrIMP is directly inserted in the closed loop, affecting the closed loop system, deteriorating the sensitivity function and thereby amplifying disturbances with frequencies close to the cancellation frequency. This is not a suitable method for a system containing a lot of induced harmonics closely coupled together as seen in Figure~\ref{fig:dist_diff_speed}.

The other two cancellation methods are based on a feedforward approach and do not affect the closed loop system. With respect to cancellation effectiveness with induced model errors (Aspect 3 and 4 in Table~\ref{tab:comp_h}), the \abbrFDC is remarkable better than the \abbrRFDC. However, this result might be misleading, due to several reasons. Firstly, this approach requires a full model of the disturbance that has to be fed with a known input signal i.e. the disturbance must be known in quite a large extent. Secondly, the \abbrFDC performance is only evaluated over one step and only works with a low step rate as input. If the step rate is to high the response could be interfering with other step responses making the disturbance even harder to model.

Considering the above with the goal to cancel out harmonic oscillations, the \abbrRFDC is the most preferable approach. It allows for cancellation of known harmonic disturbances while it only uses the angular measurement and the given output at the time to estimate the correct phase and amplitude of the disturbance. The observer converge time must be carefully estimated. In the simulations it was confirmed that the a quicker convergence implies in more noise added to the observed model, especially for high frequency models with frequencies close to the Nyquist frequency. The addition of a bandpass filter has not shown any increase of the cancellation performance. The problem lays in the fact that non modeled disturbances that enter the disturbance estimation become phase-shifted by the filter which lead to an amplification of its frequency components.

\subsection{Implementation}
The \abbrRFDC implementation showed good results, overall consistent with the results from the simulations. Cancellation was verified both in open and closed loop and with the selection of single and multiple disturbances. One important result is shown in Figure~\ref{fig:mult50no80}, where the 50Hz is canceled without affecting the 80Hz component. This also show that an environmental disturbance (not generated by a shaker), can be effectively reduced by this implementation. The environmental disturbances in the lab was much higher than the expected level of disturbance in the tunnel. This implied in a standard deviation varying between \unit{1}{\micro\radian} and \unit{10}{\micro\radian} in closed loop operation. Such a large varying standard deviation makes it difficult to compare 2 tests with each other. Hence, the reduction of the yaw angle shown in for instance Figure~\ref{fig:yl_closedloop_80} should be seen as an indication of the harmonic cancellation capability. This also explains the big difference between the open and closed loop performance, shown in Figure~\ref{fig:fft_openloop_80} and Figure~\ref{fig:fft_closedloop_80}, which in theory should have the same cancellation performance after the response has settled.

The implementation also showed an effect that was not captured in the simulations, i.e. the "beat effect" showing as an oscillation in the cancellation performance. This undesirable effect must be overcome before this algorithm can be implemented on the real controller that operates in the \abbrLHC tunnel. Solutions that could possibly mitigate this effect are discussed in the following section.

\section{Future work}
In the future, the tracking capability could be enhanced even further by combining some of the methods used in this thesis. For example to increase bandwidth and tracking capability the \abbrIRC could be implemented, and for the rejection of specific induced harmonics, the \abbrRFDC could be used without deteriorating the sensitivity to disturbances and model errors. Also an adaptive approach might be valuable to measure and adapt the controller parameters to long term effects such as thermal effects and aging of the piezoelectric actuator.

Improvement in the mechanical design could also be done. In fact, a new, high stiffness rotational stage has already been manufactured with the aim of increasing the stiffness of the system and thereby also extending the bandwidth, allowing for a more precise tracking and a better disturbance rejection. Even though it has a higher bandwidth than the previous stage, different angular and linear positions still changes the linear model drastically. The \abbrIRC is a promising control technique for handling these type of model changes (at least up to some extent) since it only uses a negative feedforward to damp out the first resonance peak and has no direct information of where the first resonance peak may be located. However, further investigation has to be carried out in order to gain a better knowledge about the controller robustness to high order model changes and techniques that can be used to be more robust to them.

To improve the already implemented \abbrRFDC method, several of adjustments can be made. For instance, a big drawback is that the frequencies that can be selected as subject for cancellation must have an integer number of periods that is a multiple of the sampling time. To achieve intersample disturbance rejection, a multi rate control technique with a control period shorter than the sampling period can be implemented, as proposed in \citep{fujimoto2009rro}. Another improvement would be to get rid of the beat effect. The effect could be mitigated by using some technique that regularly synchronizes the observed disturbance with the replicated one. One way could be to observe the disturbance at all the time and only use a few elements to synchronize the phase of the replicated disturbance. Another way could be to regularly create a new disturbance signal by updating the observed signal model, but how this technique would work in its full is left for future investigation.
